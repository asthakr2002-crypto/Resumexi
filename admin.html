<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - ResumeX AI</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body>
    <div class="gradient-bg"></div>
    <div class="dashboard-layout">
        <aside class="sidebar glass-card"
            style="border-radius: 0; border: none; border-right: 1px solid var(--glass-border);">
            <div class="logo" style="margin-bottom: 3rem;">
                <i data-lucide="sparkles" class="primary-text" style="color: var(--primary);"></i>
                <span>ResumeX AI</span>
            </div>

            <nav style="flex-direction: column; align-items: flex-start; gap: 1rem; padding: 0;">
                <a href="dashboard.html"
                    style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; width: 100%; border-radius: 0.5rem; color: var(--text-secondary);">
                    <i data-lucide="layout-dashboard"></i> Dashboard
                </a>
                <a href="admin.html"
                    style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; width: 100%; border-radius: 0.5rem; background: var(--primary); color: white;">
                    <i data-lucide="shield-check"></i> Admin Panel
                </a>
            </nav>
        </aside>

        <main class="main-content">
            <header style="margin-bottom: 3rem; display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <h1 style="font-size: 2rem; margin-bottom: 0.5rem;">Admin Control Center</h1>
                    <p style="color: var(--text-secondary);">Platform-wide analytics and user management.</p>
                </div>
            </header>

            <div class="grid" style="grid-template-columns: repeat(3, 1fr); margin-bottom: 3rem;">
                <div class="glass-card" style="padding: 2rem; position: relative; overflow: hidden;">
                    <div style="font-size: 0.875rem; color: var(--text-secondary);">Total Users</div>
                    <div style="font-size: 2.5rem; font-weight: 800;" id="admin-total-users">0</div>
                    <i data-lucide="users"
                        style="position: absolute; right: -1rem; top: -1rem; width: 6rem; height: 6rem; opacity: 0.05;"></i>
                </div>
                <div class="glass-card" style="padding: 2rem; position: relative; overflow: hidden;">
                    <div style="font-size: 0.875rem; color: var(--text-secondary);">Total Revenue</div>
                    <div style="font-size: 2.5rem; font-weight: 800; color: #10b981;" id="admin-total-revenue">$0.00
                    </div>
                    <i data-lucide="dollar-sign"
                        style="position: absolute; right: -1rem; top: -1rem; width: 6rem; height: 6rem; opacity: 0.05;"></i>
                </div>
                <div class="glass-card" style="padding: 2rem; position: relative; overflow: hidden;">
                    <div style="font-size: 0.875rem; color: var(--text-secondary);">Resumes Analyzed</div>
                    <div style="font-size: 2.5rem; font-weight: 800; color: var(--accent-purple);"
                        id="admin-total-resumes">0</div>
                    <i data-lucide="file-check"
                        style="position: absolute; right: -1rem; top: -1rem; width: 6rem; height: 6rem; opacity: 0.05;"></i>
                </div>
            </div>

            <div class="glass-card" style="overflow: hidden;">
                <div
                    style="padding: 1.5rem; border-bottom: 1px solid var(--glass-border); background: rgba(255,255,255,0.02);">
                    <h3 style="font-size: 1.125rem;">Platform Users</h3>
                </div>
                <table style="width: 100%; border-collapse: collapse; text-align: left;">
                    <thead>
                        <tr
                            style="border-bottom: 1px solid var(--glass-border); font-size: 0.75rem; text-transform: uppercase; color: var(--text-secondary);">
                            <th style="padding: 1.5rem;">User</th>
                            <th style="padding: 1.5rem;">Role</th>
                            <th style="padding: 1.5rem;">Joined</th>
                            <th style="padding: 1.5rem; text-align: right;">Action</th>
                        </tr>
                    </thead>
                    <tbody id="user-table-body">
                        <!-- Users will be injected here -->
                    </tbody>
                </table>
            </div>
        </main>
    </div>

    <script src="js/api.js"></script>
    <script>
        lucide.createIcons();

        async function initAdmin() {
            try {
                const stats = await API.getAdminStats();
                const users = await API.getAllUsers();

                document.getElementById('admin-total-users').textContent = stats.totalUsers;
                document.getElementById('admin-total-revenue').textContent = '$' + stats.totalRevenue.toFixed(2);
                document.getElementById('admin-total-resumes').textContent = stats.totalResumes;

                const tbody = document.getElementById('user-table-body');
                users.forEach(user => {
                    const tr = document.createElement('tr');
                    tr.style.borderBottom = '1px solid var(--glass-border)';
                    tr.style.transition = 'background 0.3s';
                    tr.onmouseover = () => tr.style.background = 'rgba(255,255,255,0.02)';
                    tr.onmouseout = () => tr.style.background = 'transparent';

                    tr.innerHTML = `
                        <td style="padding: 1.5rem;">
                            <div style="font-weight: 600;">${user.name}</div>
                            <div style="font-size: 0.75rem; color: var(--text-secondary);">${user.email}</div>
                        </td>
                        <td style="padding: 1.5rem;">
                            <span style="font-size: 0.625rem; font-weight: 800; text-transform: uppercase; padding: 0.25rem 0.5rem; border-radius: 4px; border: 1px solid ${user.role === 'ADMIN' ? 'var(--primary)' : 'var(--glass-border)'}; color: ${user.role === 'ADMIN' ? 'var(--primary)' : 'var(--text-secondary)'};">
                                ${user.role}
                            </span>
                        </td>
                        <td style="padding: 1.5rem; font-size: 0.875rem; color: var(--text-secondary);">
                            ${new Date(user.createdAt).toLocaleDateString()}
                        </td>
                        <td style="padding: 1.5rem; text-align: right;">
                            <button style="background: none; border: none; color: #ef4444; cursor: pointer;"><i data-lucide="trash-2"></i></button>
                        </td>
                    `;
                    tbody.appendChild(tr);
                });
                lucide.createIcons();
            } catch (err) {
                console.error(err);
            }
        }

        initAdmin();
    </script>
</body>

</html>