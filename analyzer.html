<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analyzer - ResumeX AI</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>

<body>
    <div class="gradient-bg"></div>
    <div class="dashboard-layout">
        <aside class="sidebar glass-card"
            style="border-radius: 0; border: none; border-right: 1px solid var(--glass-border);">
            <div class="logo" style="margin-bottom: 3rem;">
                <i data-lucide="sparkles" class="primary-text" style="color: var(--primary);"></i>
                <span>ResumeX AI</span>
            </div>

            <nav style="flex-direction: column; align-items: flex-start; gap: 1rem; padding: 0;">
                <a href="dashboard.html"
                    style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; width: 100%; border-radius: 0.5rem; color: var(--text-secondary);">
                    <i data-lucide="layout-dashboard"></i> Dashboard
                </a>
                <a href="analyzer.html"
                    style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; width: 100%; border-radius: 0.5rem; background: var(--primary); color: white;">
                    <i data-lucide="upload"></i> Upload Resume
                </a>
            </nav>
        </aside>

        <main class="main-content">
            <header style="margin-bottom: 3rem;">
                <h1 style="font-size: 2rem; margin-bottom: 0.5rem;">AI Resume Analyzer</h1>
                <p style="color: var(--text-secondary);">Upload your resume to get instant feedback and ATS optimization
                    tips.</p>
            </header>

            <div id="upload-section" class="glass-card"
                style="padding: 4rem; text-align: center; border: 2px dashed var(--glass-border);">
                <div
                    style="width: 4rem; height: 4rem; background: rgba(99, 102, 241, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--primary); margin: 0 auto 2rem;">
                    <i data-lucide="upload" size="32"></i>
                </div>
                <h3 style="margin-bottom: 0.5rem;">Drag and drop your file here</h3>
                <p style="color: var(--text-secondary); margin-bottom: 2rem;">Supported formats: PDF (Max 5MB)</p>

                <input type="file" id="file-input" style="display: none;" accept=".pdf">
                <label for="file-input" class="btn-primary" style="cursor: pointer;">Select File</label>

                <p id="file-name" style="margin-top: 1.5rem; color: var(--primary); font-weight: 600;"></p>

                <button id="analyze-btn" class="btn-primary"
                    style="margin-top: 2.5rem; padding: 1rem 3rem; display: none;">
                    Start AI Analysis
                </button>
            </div>

            <div id="loading-section" style="display: none; text-align: center; padding: 4rem;">
                <div
                    style="width: 3rem; height: 3rem; border: 4px solid rgba(255, 255, 255, 0.1); border-top-color: var(--primary); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 2rem;">
                </div>
                <h3>Parsing Resume...</h3>
                <p style="color: var(--text-secondary);">Our AI is matching your skills with industry standards.</p>
            </div>

            <div id="results-section" style="display: none;">
                <div class="grid" style="grid-template-columns: 2fr 1fr;">
                    <div class="glass-card" style="padding: 2.5rem;">
                        <div
                            style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 2rem;">
                            <div>
                                <h2 style="font-size: 1.5rem; margin-bottom: 0.5rem;">ATS Match Score</h2>
                                <p style="color: var(--text-secondary);">Based on industry-standard keyword analysis.
                                </p>
                            </div>
                            <div style="font-size: 3.5rem; font-weight: 800; color: var(--primary);" id="result-score">
                                0%</div>
                        </div>

                        <div
                            style="width: 100%; height: 0.75rem; background: rgba(255, 255, 255, 0.05); border-radius: 1rem; overflow: hidden; margin-bottom: 3rem;">
                            <div id="score-fill"
                                style="height: 100%; background: linear-gradient(to right, var(--primary), var(--accent-purple)); width: 0%; transition: width 1.5s ease-out;">
                            </div>
                        </div>

                        <div style="display: grid; gap: 2rem;">
                            <div>
                                <h4
                                    style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem; color: #10b981;">
                                    <i data-lucide="check-circle-2" size="18"></i> Found Skills
                                </h4>
                                <div id="found-skills" style="display: flex; flex-wrap: wrap; gap: 0.5rem;"></div>
                            </div>
                            <div>
                                <h4
                                    style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem; color: #ef4444;">
                                    <i data-lucide="x-circle" size="18"></i> Missing Skills
                                </h4>
                                <div id="missing-skills" style="display: flex; flex-wrap: wrap; gap: 0.5rem;"></div>
                            </div>
                        </div>
                    </div>

                    <div style="display: grid; gap: 1.5rem;">
                        <div class="glass-card"
                            style="padding: 1.5rem; background: rgba(99, 102, 241, 0.05); border-color: rgba(99, 102, 241, 0.2);">
                            <h3
                                style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem; font-size: 1rem;">
                                <i data-lucide="info" size="18"></i> recommendations
                            </h3>
                            <p id="result-rec"
                                style="font-size: 0.875rem; color: var(--text-secondary); line-height: 1.6;"></p>
                        </div>
                        <div class="glass-card" style="padding: 1.5rem;">
                            <h3
                                style="font-size: 0.875rem; text-transform: uppercase; color: var(--text-secondary); margin-bottom: 1.5rem;">
                                Recommended Path</h3>
                            <div style="display: grid; gap: 1rem;">
                                <div
                                    style="padding: 0.75rem; border-radius: 0.5rem; background: rgba(255,255,255,0.03); border: 1px solid var(--glass-border); font-size: 0.875rem;">
                                    Senior Software Engineer</div>
                                <div
                                    style="padding: 0.75rem; border-radius: 0.5rem; background: rgba(255,255,255,0.03); border: 1px solid var(--glass-border); font-size: 0.875rem;">
                                    Cloud Architect</div>
                            </div>
                        </div>
                    </div>
                </div>
                <button onclick="window.location.reload()"
                    style="margin-top: 2rem; background: none; border: none; color: var(--text-secondary); cursor: pointer; font-weight: 500;">
                    ‚Üê Analyze another resume
                </button>
            </div>
        </main>
    </div>

    <style>
        @keyframes spin {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        .skill-tag {
            padding: 0.25rem 0.75rem;
            border-radius: 99px;
            font-size: 0.75rem;
            font-weight: 600;
            border: 1px solid transparent;
        }

        .tag-found {
            background: rgba(16, 185, 129, 0.1);
            color: #10b981;
            border-color: rgba(16, 185, 129, 0.2);
        }

        .tag-missing {
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
            border-color: rgba(239, 68, 68, 0.2);
        }
    </style>

    <script src="js/api.js"></script>
    <script>
        lucide.createIcons();
        const fileInput = document.getElementById('file-input');
        const fileName = document.getElementById('file-name');
        const analyzeBtn = document.getElementById('analyze-btn');

        fileInput.onchange = (e) => {
            const file = e.target.files[0];
            if (file) {
                fileName.textContent = 'Selected: ' + file.name;
                analyzeBtn.style.display = 'inline-flex';
            }
        };

        analyzeBtn.onclick = async () => {
            const file = fileInput.files[0];
            if (!file) return;

            document.getElementById('upload-section').style.display = 'none';
            document.getElementById('loading-section').style.display = 'block';

            try {
                const result = await API.uploadResume(file);
                const analysis = await API.getAnalysis(result.id);

                document.getElementById('loading-section').style.display = 'none';
                document.getElementById('results-section').style.display = 'block';

                document.getElementById('result-score').textContent = result.atsScore.toFixed(0) + '%';
                setTimeout(() => {
                    document.getElementById('score-fill').style.width = result.atsScore + '%';
                }, 100);

                const foundContainer = document.getElementById('found-skills');
                analysis.skillsFound.split('|')[0].split(',').forEach(s => {
                    if (!s.trim()) return;
                    const span = document.createElement('span');
                    span.className = 'skill-tag tag-found';
                    span.textContent = s.trim();
                    foundContainer.appendChild(span);
                });

                const missingContainer = document.getElementById('missing-skills');
                analysis.skillsMissing.split(',').forEach(s => {
                    if (!s.trim()) return;
                    const span = document.createElement('span');
                    span.className = 'skill-tag tag-missing';
                    span.textContent = s.trim();
                    missingContainer.appendChild(span);
                });

                document.getElementById('result-rec').textContent = analysis.recommendations;

                if (result.atsScore > 70) {
                    confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
                }
            } catch (err) {
                console.error(err);
                alert('Analysis failed');
                window.location.reload();
            }
        };
    </script>
</body>


</html>
